<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MyInfoMapper">

<select id="myInfo" resultType="MemberVO">
SELECT M.ID, U.NAME, U.BIRTH, U.EMAIL, U.PHONE, U.JOB, R.ROLE
FROM MEMBER M
INNER JOIN USER_INFO U ON M.ID=U.ID
INNER JOIN ROLE R ON M.ID=R.ID
WHERE M.ID=#{id}
</select>

<select id="passwordCheck" resultType="String">
SELECT PWD FROM MEMBER WHERE ID=#{id}
</select>

<select id="modify" resultType="MemberVO">
SELECT M.ID, U.NAME, U.BIRTH, U.GENDER, U.PHONE, U.EMAIL, U.ADDRESS, R.ROLE
FROM MEMBER M
INNER JOIN USER_INFO U ON M.ID=U.ID
INNER JOIN ROLE R ON M.ID=R.ID
WHERE M.ID=#{id}
</select>

<update id="updateMember">
UPDATE MEMBER SET PWD=#{pwd} WHERE ID=#{id}
</update>

<update id="updateUser_info">
UPDATE USER_INFO SET NAME=#{name}, JOB=#{job}, PHONE=#{phone}, EMAIL=#{email}, ADDRESS=#{address}, HANDICAP=#{handicap} WHERE ID=#{id}
</update>

<delete id="deleteMember">
DELETE FROM MEMBER WHERE ID=#{id}
</delete>

<delete id="deleteUser_info">
DELETE FROM USER_INFO WHERE ID=#{id}
</delete>

<delete id="deleteRole">
DELETE FROM ROLE WHERE ID=#{id}
</delete>

<select id="currentRent" resultType="MyInfoVO">
SELECT R.RENT_DATE, R.SUBMIT_DATE, RB.BRENT, B.BTITLE
FROM RENT_BOOK R
INNER JOIN BOOK B ON R.BNO=B.BNO 
INNER JOIN ROOM_B RB ON R.BNO=RB.BNO
WHERE R.ID=#{id}
</select>

<select id="reserveBook" resultType="MyInfoVO">
SELECT RE.RESERVE_DATE, RE.RESERVE_END, RB.SUBMIT_DATE, B.BTITLE, RM.BRENT
FROM RESERVE_BOOK RE
INNER JOIN BOOK B ON RE.BNO=B.BNO 
INNER JOIN RENT_BOOK RB ON RE.BNO=RB.BNO 
INNER JOIN ROOM_B RM ON RE.BNO=RM.BNO
WHERE RE.ID=#{id}
</select>

</mapper>